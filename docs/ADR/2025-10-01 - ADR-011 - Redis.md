# ADR-011: Adopt Microsoft.Extensions.StackExchange.Redis for Caching

## Status
Decided

## Context
Our application requires a distributed caching solution to improve performance, reduce database load, and handle frequently accessed data across multiple instances. The solution must integrate seamlessly with ASP.NET Core, support modern Redis features, and provide a reliable and maintainable API for caching, including support for expiration policies, key management, and potential future clustering. We also want a well-supported and actively maintained library that aligns with .NET standards.

## Decision
We will adopt **Microsoft.Extensions.StackExchange.Redis** as the distributed caching solution throughout the application.

## Rationale

**Official Microsoft Support**
- Developed and maintained by Microsoft with long-term support plans
- Integrates natively with ASP.NET Core through `AddStackExchangeRedisCache`
- Aligns with dependency injection and configuration patterns used in the project

**Feature-Rich and Efficient**
- Full support for Redis features including expiration, pub/sub, and transactions
- Efficient memory usage and high-performance access to cache data
- Compatible with Redis clusters for horizontal scaling if needed

**Ease of Use**
- Simple API for basic caching scenarios (`Get`, `Set`, `Remove`)
- Works seamlessly with `IOptions` and `IDistributedCache` abstraction
- Reduces boilerplate compared to manually managing Redis connections
- Easy to integrate with existing services and background jobs

**Active Community and Documentation**
- Widely used in the .NET ecosystem
- Extensive documentation and examples available
- Supports modern .NET features such as asynchronous access and cancellation tokens

## Consequences

### Positive
- Reliable, production-ready caching backed by Redis
- Native integration with ASP.NET Core DI and configuration
- High-performance caching with minimal code overhead
- Easy to extend to distributed scenarios and clustering
- Strong ecosystem support and long-term maintenance

### Negative
- Adds a dependency on Redis server infrastructure
- Potential learning curve for advanced Redis features
- Requires monitoring and proper configuration for production-scale deployments
- Network latency may impact performance in remote Redis setups

### Implementation Notes
- Register Redis in `Program.cs` using `AddStackExchangeRedisCache`
- Configure connection string, default database, and optional instance name via `IConfiguration`
- Use `IDistributedCache` in services for abstraction over Redis operations
- Implement proper key naming conventions and expiration policies
- Consider using a wrapper service for advanced caching patterns (bulk get/set, versioned keys)
- Monitor Redis performance using metrics and logging in production
- Validate cache consistency and eviction policies through integration tests

## Alternatives Considered

**MemoryCache (Microsoft.Extensions.Caching.Memory)**: Rejected because it is in-memory only, not distributed, and cannot be shared across multiple instances.

**StackExchange.Redis directly**: Rejected in favor of the Microsoft extension to leverage DI and configuration abstractions, reducing boilerplate and integration complexity.

**Third-party libraries (e.g., EasyCaching.Redis)**: Rejected due to additional abstraction layers and less widespread adoption compared to the official Microsoft package.

## References
- Microsoft Documentation: https://learn.microsoft.com/en-us/aspnet/core/performance/caching/distributed
- StackExchange.Redis GitHub Repository: https://github.com/StackExchange/StackExchange.Redis
